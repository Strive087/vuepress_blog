# 面试

## js并发请求

```js
function createRequest({pool = 2}){
  let queueLength = 0;
  let waitingQueue = [];
  return function request(url){
      if(queueLength < pool && url){
          queueLength++;
          fetch(url).then(()=>{
              queueLength--;
              request(waitingQueue.shift());
          })
      }else{
          waitingQueue.push(url);
      }
  }
}
const request = createRequest({ pool: 4 });
Array(10)
.fill(1)
.forEach(() => request("https://mock.yonyoucloud.com/mock/17479/czzp-demo/getMenus"))
```

## 随机生成一段Json

```js
//最大层级level，最大子数目maxChildren，数值任意
function generateJson(level = 1,maxChildren = 1){
  if(level < 1){
    return Math.round(Math.random()*10);
  }
  let json = {};
  let randomChildrenNum = Math.round(Math.random()*maxChildren) || 1;
  let randomChildrenlevel = Math.round(Math.random()*randomChildrenNum) || 1;
  for(let j = 1; j <= randomChildrenNum - randomChildrenlevel; j++){
    json['val'+j] = Math.round(Math.random()*10);
  }
  for(let k = 1; k <= randomChildrenlevel; k++){
    json['val'+k] = generateJson(--level,maxChildren);
  }
  return json;
}
console.log(JSON.stringify(generateJson(3,4),null,2));
```

## 深度不定的树形数据，给一个节点，输出从根节点到当前节点的路径

```js
function getNodePath(root, node) {
  let path = "",pathArr = [];
  if (root) {
    _getNodePath(root)
    console.log(pathArr);
  }
  function _getNodePath(root) {
    const str = "->" + root.value;
    path += str;
    if (root.value == node.value && contrast(node, root)) {
      pathArr.push(path.slice(2));
    }
    if (root.left) _getNodePath(root.left);
    if (root.right) _getNodePath(root.right);
    path = path.substr(0, path.length - str.length);
  }
  function contrast(node, currentNode) {
    if (node == null && currentNode == null) {
      return true;
    }
    if (node && currentNode && node.value == currentNode.value) {
      return (
        contrast(node.left, currentNode.left) &&
        contrast(node.right, currentNode.right)
      );
    } else {
      return false;
    }
  }
}

var root = JSON.parse(
  `{
    "value": 0,
    "right": {
      "value": 1,
      "left": {
        "value": 2,
        "left": {
          "value": 3,
          "right": {
            "value": 4,
            "left": {
              "value": 5,
              "left": {
                "value": 6,
                "left": {
                  "value": 8,
                  "left": {
                    "value": 11
                  },
                  "right": {
                    "value": 12
                  }
                },
                "right": {
                  "value": 9
                }
              },
              "right": {
                "value": 7,
                "right": {
                  "value": 10
                }
              }
            }
          }
        }
      }
    }
  }`
);
var node = JSON.parse(`{
  "value": 6,
  "left": {
    "value": 8,
    "left": {
      "value": 11
    },
    "right": {
      "value": 12
    }
  },
  "right": {
    "value": 9
  }
}`);

getNodePath(root, node);
```
